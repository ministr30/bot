# üìã –û—Ç—á–µ—Ç –æ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –±–æ—Ç–∞ –¥–æ python-telegram-bot v21+

## üî¥ –ü—Ä–æ–±–ª–µ–º—ã —Å python-telegram-bot v21+

### 1. **Event Loop –∫–æ–Ω—Ñ–ª–∏–∫—Ç**

**–ü—Ä–æ–±–ª–µ–º–∞:** `RuntimeError: This event loop is already running`

**–ü—Ä–∏—á–∏–Ω–∞:** –í python-telegram-bot v21+ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ event loop, —á—Ç–æ –ø—Ä–∏–≤–µ–ª–æ –∫ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞–º —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∫–æ–¥–æ–º.

**–û—à–∏–±–∫–∞:**
```
RuntimeError: This event loop is already running
RuntimeError: Cannot close a running event loop
```

### 2. **–ö–æ–Ω—Ñ–ª–∏–∫—Ç —Å Supabase**

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –≤–µ—Ä—Å–∏–π httpx:
- `python-telegram-bot>=21.0` —Ç—Ä–µ–±—É–µ—Ç `httpx<0.29,>=0.27`
- `supabase>=2.6.0` —Ç—Ä–µ–±—É–µ—Ç `httpx<0.28,>=0.24`

**–ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã:**
```
supabase 2.8.1 requires httpx<0.28,>=0.24, but you have httpx 0.28.1
```

## ‚úÖ –†–ï–®–ï–ù–ò–ï: –û—Ç–∫–∞—Ç –∫ python-telegram-bot 20.7

### **–û—Å–Ω–æ–≤–Ω–æ–π –±–æ—Ç (telegram_bot.py)** ‚úÖ **–†–ê–ë–û–¢–ê–ï–¢**

**–°—Ç–∞—Ç—É—Å:** –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω
**–í–µ—Ä—Å–∏—è:** python-telegram-bot==20.7
**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –±–µ–∑ event loop –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
- –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å Supabase
- –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

**–ó–∞–ø—É—Å–∫:**
```powershell
cd app/telegram_bot
python telegram_bot.py
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- ‚úÖ –í–æ–∑–≤—Ä–∞—Ç –∫ `Application.builder()` –≤–º–µ—Å—Ç–æ `ApplicationBuilder()`
- ‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π `application.run_polling()` –≤–º–µ—Å—Ç–æ async
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è APScheduler
- ‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º—ã–µ –≤–µ—Ä—Å–∏–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

## üìä –°—Ç–∞—Ç—É—Å —Ä–µ—à–µ–Ω–∏—è

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | –í–µ—Ä—Å–∏—è | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
|-----------|--------|--------|------------|
| **telegram_bot.py** | ‚úÖ **–†–ê–ë–û–¢–ê–ï–¢** | PTB 20.7 | –û—Å–Ω–æ–≤–Ω–æ–π –±–æ—Ç |
| python-telegram-bot | ‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º | 20.7 | –°—Ç–∞–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è |
| supabase | ‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º | 1.2.0 | –†–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ |
| httpx | ‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º | 0.27.0 | –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è PTB 20.7 |

## üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. **–û—Ç–∫–∞—Ç –∫ v20.7**
- ‚úÖ –ò–∑–º–µ–Ω–µ–Ω `ApplicationBuilder()` –æ–±—Ä–∞—Ç–Ω–æ –Ω–∞ `Application.builder()`
- ‚úÖ –£–±—Ä–∞–Ω `async def main()` –∏ `asyncio.run()`
- ‚úÖ –í–æ–∑–≤—Ä–∞—â–µ–Ω —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π `application.run_polling()`
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω event loop –∫–æ–Ω—Ñ–ª–∏–∫—Ç

### 2. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞**
- ‚úÖ APScheduler –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –¥–æ `run_polling()`
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤ —Ç–µ–∫—É—â–µ–º event loop

### 3. **–°–æ–≤–º–µ—Å—Ç–∏–º—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**
- ‚úÖ `python-telegram-bot==20.7`
- ‚úÖ `supabase==1.2.0`
- ‚úÖ `httpx==0.27.0`

## üöÄ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:
- **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ telegram_bot.py** - –æ—Å–Ω–æ–≤–Ω–æ–π –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:
- **telegram_bot.py** - –æ—Å–Ω–æ–≤–Ω–æ–π –±–æ—Ç —Å –ø–æ–ª–Ω—ã–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–æ–º

### –ó–∞–ø—É—Å–∫:
```powershell
# –ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
cd app/telegram_bot
python telegram_bot.py
```

## üìù –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–û—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞:** –†–µ—à–µ–Ω–∞ –æ—Ç–∫–∞—Ç–æ–º –∫ python-telegram-bot v20.7

**–†–µ—à–µ–Ω–∏–µ:** –û—Å–Ω–æ–≤–Ω–æ–π –±–æ—Ç —Å python-telegram-bot v20.7

**–°—Ç–∞—Ç—É—Å:** –ü—Ä–æ–±–ª–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ—à–µ–Ω–∞ ‚úÖ

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –û–¥–∏–Ω —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –æ—Å–Ω–æ–≤–Ω–æ–π –±–æ—Ç

---

*–û—Ç—á–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω: 13.08.2025*
*–°—Ç–∞—Ç—É—Å: –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ—à–µ–Ω–æ ‚úÖ*
